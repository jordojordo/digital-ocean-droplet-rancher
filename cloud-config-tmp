#cloud-config

package_update: true
package_upgrade: false

packages:
  - git

runcmd:
  - "curl https://releases.rancher.com/install-docker/20.10.sh | sh"
  - "mkdir -p /root/dashboard"
  - "wget https://raw.githubusercontent.com/jordojordo/digital-ocean-droplet-rancher/main/Dockerfile -P /root/"
  - "git clone --branch <REPO_BRANCH> <REPO_URL> /root/dashboard"
  - "docker build --file /root/Dockerfile -t dashboard:dev ."
  - "docker run -d --restart unless-stopped --privileged -p 80:80 -p 443:443 -e CATTLE_UI_DASHBOARD_INDEX=https://localhost/dashboard/index.html dashboard:dev"
  - [sh, -xc, "echo $(date) ': Time to do the stuff'"]
